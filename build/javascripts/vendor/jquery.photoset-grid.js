/**
 * photoset-grid - v1.0.1
 * 2014-04-08
 * jQuery plugin to arrange images into a flexible grid
 * http://stylehatch.github.com/photoset-grid/
 *
 * Copyright 2014 Jonathan Moore - Style Hatch
 */
!function(t,i,s,e){"use strict";function o(i,s){this.element=i,this.options=t.extend({},h,s),this._defaults=h,this._name=n,this.init()}var n="photosetGrid",h={width:"100%",gutter:"0px",highresLinks:!1,lowresWidth:500,rel:"",onInit:function(){},onComplete:function(){}};o.prototype={init:function(){this.options.onInit(),this._setupRows(this.element,this.options),this._setupColumns(this.element,this.options)},_callback:function(t){this.options.onComplete(t)},_setupRows:function(i,s){if(s.layout)this.layout=s.layout;else if(t(i).attr("data-layout"))this.layout=t(i).attr("data-layout");else{for(var e="",o=1,n=0;n<t(i).find("img").length;n++)e+=o.toString();this.layout=e}this.rows=this.layout.split("");for(var h in this.rows)this.rows[h]=parseInt(this.rows[h],10);var a=t(i).find("img"),r=0;t.each(this.rows,function(t,i){var s=r,e=r+i;a.slice(s,e).wrapAll('<div class="photoset-row cols-'+i+'"></div>'),r=e}),t(i).find(".photoset-row:not(:last-child)").css({"margin-bottom":s.gutter})},_setupColumns:function(s,e){var o=this,n=function(o){function n(){var i=t(s).width().toString();i!==t(s).attr("data-width")&&(h.each(function(){var i=t(this).find("img:eq(0)");t(this).find("img").each(function(){var s=t(this);s.attr("height")<i.attr("height")&&(i=t(this)),parseInt(s.css("width"),10)>e.lowresWidth&&s.attr("data-highres")&&s.attr("src",s.attr("data-highres"))});var s=i.attr("height")*parseInt(i.css("width"),10)/i.attr("width"),o=Math.floor(.025*s);t(this).height(s-o),t(this).find("img").each(function(){var i=t(this).attr("height")*parseInt(t(this).css("width"),10)/t(this).attr("width"),e=.5*(s-i)+"px";t(this).css({"margin-top":e})})}),t(s).attr("data-width",i))}var h=t(s).find(".photoset-row"),a=t(s).find("img");e.highresLinks?(a.each(function(){var i;i=t(this).attr(t(this).attr("data-highres")?"data-highres":"src"),t(this).wrapAll('<a href="'+i+'" class="photoset-cell highres-link" />')}),e.rel&&a.parent().attr("rel",e.rel)):a.each(function(){t(this).wrapAll('<div class="photoset-cell" />')});var r=t(s).find(".photoset-cell"),l=t(s).find(".cols-1 .photoset-cell"),c=t(s).find(".cols-2 .photoset-cell"),d=t(s).find(".cols-3 .photoset-cell"),f=t(s).find(".cols-4 .photoset-cell"),u=t(s).find(".cols-5 .photoset-cell");t(s).css({width:e.width}),h.css({clear:"left",display:"block",overflow:"hidden"}),r.css({"float":"left",display:"block","line-height":"0","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box","box-sizing":"border-box"}),a.css({width:"100%",height:"auto"}),o&&a.each(function(){t(this).attr("height",t(this).height()),t(this).attr("width",t(this).width())}),l.css({width:"100%"}),c.css({width:"50%"}),d.css({width:"33.3%"}),f.css({width:"25%"}),u.css({width:"20%"});var p=parseInt(e.gutter,10);t(s).find(".photoset-cell:not(:last-child)").css({"padding-right":p/2+"px"}),t(s).find(".photoset-cell:not(:first-child)").css({"padding-left":p/2+"px"}),n(),t(i).on("resize",function(){n()})},h=!0,a=!0;t(s).find("img").each(function(){a&=!!t(this).attr("height")&!!t(this).attr("width")}),h=!a,h?t(s).imagesLoaded(function(){n(h),o._callback(s)}):(n(h),o._callback(s))}},t.fn[n]=function(i){return this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new o(this,i))})};/*!
     * jQuery imagesLoaded plugin v2.1.1
     * http://github.com/desandro/imagesloaded
     *
     * MIT License. by Paul Irish et al.
     */
var a="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";t.fn.imagesLoaded=function(i){function s(){var s=t(f),e=t(u);r&&(u.length?r.reject(c,s,e):r.resolve(c)),t.isFunction(i)&&i.call(h,c,s,e)}function o(t){n(t.target,"error"===t.type)}function n(i,e){i.src!==a&&-1===t.inArray(i,d)&&(d.push(i),e?u.push(i):f.push(i),t.data(i,"imagesLoaded",{isBroken:e,src:i.src}),l&&r.notifyWith(t(i),[e,c,t(f),t(u)]),c.length===d.length&&(setTimeout(s),c.unbind(".imagesLoaded",o)))}var h=this,r=t.isFunction(t.Deferred)?t.Deferred():0,l=t.isFunction(r.notify),c=h.find("img").add(h.filter("img")),d=[],f=[],u=[];return t.isPlainObject(i)&&t.each(i,function(t,s){"callback"===t?i=s:r&&r[t](s)}),c.length?c.bind("load.imagesLoaded error.imagesLoaded",o).each(function(i,s){var o=s.src,h=t.data(s,"imagesLoaded");return h&&h.src===o?void n(s,h.isBroken):s.complete&&s.naturalWidth!==e?void n(s,0===s.naturalWidth||0===s.naturalHeight):void((s.readyState||s.complete)&&(s.src=a,s.src=o))}):s(),r?r.promise(h):h};/*
     * throttledresize: special jQuery event that happens at a reduced rate compared to "resize"
     *
     * latest version and complete README available on Github:
     * https://github.com/louisremi/jquery-smartresize
     *
     * Copyright 2012 @louis_remi
     * Licensed under the MIT license.
     *
     * This saved you an hour of work? 
     * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
     */
var r,l,c,d=t.event,f={_:0},u=0;r=d.special.throttledresize={setup:function(){t(this).on("resize",r.handler)},teardown:function(){t(this).off("resize",r.handler)},handler:function(i,s){var e=this,o=arguments;l=!0,c||(setInterval(function(){u++,(u>r.threshold&&l||s)&&(i.type="throttledresize",d.dispatch.apply(e,o),l=!1,u=0),u>9&&(t(f).stop(),c=!1,u=0)},30),c=!0)},threshold:0}}(jQuery,window,document);